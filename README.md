# WampClient

**UNDER DEVELOPMENT!**

Client for talking to a WAMP Router.  This is defined at

    https://tools.ietf.org/html/draft-oberstet-hybi-tavendo-wamp-02

## Installation

Add this line to your application's Gemfile:

```ruby
gem 'wamp_client'
```

And then execute:

    $ bundle

Or install it yourself as:

    $ gem install wamp_client

## Usage


### Subscribe

### Unsubscribe

### Publish
This method publishes an event to all of the subscribers.  The prototype for the method is

```ruby
publish(topic, args=nil, kwargs=nil, options={}, callback=nil)
```

where the parameters are defined as

 - topic [String] The topic to subscribe to
 - args [Array] The arguments
 - kwargs [Hash] The keyword arguments
 - options [Hash] The options for the subscription
 - callback [lambda] The callback(publish, error, details) is called to signal if the publish was a success or not

To publish, do the following

```ruby
session.publish('com.example.topic', [15], {param: value})
```

If you would like confirmation, do the following

```ruby
callback = lambda do |publish, error, details|
  # TODO: Do something
end

session.publish('com.example.topic', [15], {param: value}, {acknowledge: true}, callback)
```

Options are

 - acknowledge - set to "true" if you want the Broker to acknowledge if the Publish was successful or not

## Contributing

1. Fork it ( https://github.com/ericchapman/ruby_wamp_client )
2. Create your feature branch (`git checkout -b my-new-feature`)
3. Commit your changes (`git commit -am 'Add some feature'`)
4. Push to the branch (`git push origin my-new-feature`)
5. Create a new Pull Request

### Testing

The unit tests are run as follows

    $ bundle exec rake spec

### Scripts

#### Message

The *lib/wamp_client/message.rb* file and the *spec/message_spec.rb* file are autogenerated using the script
*scripts/gen_message.rb*.  This is done as follows

    $ cd scripts
    $ ./gen_message.rb
    $ mv message.rb.tmp ../lib/wamp_client/message.rb
    $ mv message_spec.rb.tmp ../spec/message_spec.rb

As I was writing the code for the messages I caught myself cutting and pasting allot and decided these would be
better suited to be autogenerated.
